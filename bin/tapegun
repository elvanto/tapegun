#!/usr/bin/env php
<?php

//only want to see errors once in terminal (logs go to std out in a default php cli setup)
if (ini_get('log_errors') && ini_get('display_errors') ) {
    ini_set('log_errors', 0);
}

if (file_exists(__DIR__ . '/../vendor/autoload.php')) {
    require_once(__DIR__ . '/../vendor/autoload.php');
} elseif (file_exists(__DIR__ . '/../../../autoload.php')) {
    require_once(__DIR__ . '/../../../autoload.php');
}

try {
    $app = new \Symfony\Component\Console\Application('Tapegun', \Tapegun\Tapegun::VERSION);
    $app->add(new \Tapegun\Command\Build());
    $run = $app->run();

    if (intval($run) === 0){
        echo "\n\n✔️ Operations successful.\n";
    } else {
        echo "\n\n❌ Error Operations failed with exit code $run \n";
    }
    //pass the exit code up the chain
    exit($run);
} catch (Throwable $e) {
    echo "\n\n❌ Error: " . $e->getMessage()."\n";
    //exit with an error code
    exit(2);
}

